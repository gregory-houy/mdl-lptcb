<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="rT7FhVtgQ3VDwmpmEIGLUB0xlYUB9ziTsrN9BKJCKbk" />
    <title>Prix - MDL du Lyc√©e</title>
    <link rel="stylesheet" href="style.css">
    <link rel="website icon" type="png" href="images/logos/mdl-onglet.png">
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <a href="https://mdl-lptcb.vercel.app">
                    <img src="/images/logos/mdl-lycee-sombre.png" alt="logo">
                </a>
            </div>
            <button class="hamburger-menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links">
                <li><a href="index.html">Accueil</a></li>
                <li><a href="journees-thematiques.html">Journ√©es √† Th√®mes</a></li>
                <li><a href="actualites.html">Actualit√©s</a></li>
                <li><a href="trombinoscope.html">Notre √©quipe</a></li>
                <li><a href="horaires.html">Horaires d'ouverture</a></li>
                <li><a href="vente.html">Vente</a></li>
                <li><a href="prix.html" class="active">Prix</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="boite-a-idee.html">Boite √† id√©es</a></li>
                <li><a href="https://my.matterport.com/show/?m=zjwMjjYAivi" target="_blank">Visite virtuelle</a></li>
            </ul>
            <a href="https://page-de-connexion-html.vercel.app" class="login-button">Espace membre</a>
        </nav>
    </header>

    <main class="container">
        <h1>Les Prix</h1>
        <br>
        
        <p>
            Pour b√©n√©ficier des prix adh√©rents, vous pouvez vous inscrire en cliquant sur le lien ci-dessous :<br>
            <a href="http://adhesion-mdl-lptcb.vercel.app/" style="color: #FF9200; text-decoration: none;" target="_blank">
                <b>B√©n√©ficier des prix adh√©rents</b>
            </a>
        </p>
        <br>

        <!-- Section g√©n√©r√©e automatiquement -->
        <section id="section-prix">
            <p><i>Chargement des prix en cours...</i></p>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 MDL du Lyc√©e Ch√¢teau Blanc</p>
    </footer>

    <!-- Bouton dark mode -->
    <button id="darkModeToggle" class="dark-mode-toggle">
        üåô
    </button>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
    <script>
        const supabaseUrl = "https://iarukjyswplvmtcxjtbx.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhcnVranlzd3Bsdm10Y3hqdGJ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwNTYwMjUsImV4cCI6MjA3MTYzMjAyNX0.jC33JZm5vwOROpxEMBCRQTaGwe-TF06fRMHg1UcoHxY";
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        async function chargerPrix() {
            const { data, error } = await supabase
                .from("prix")
                .select("*")
                .order("categorie", { ascending: true });

            const container = document.getElementById("section-prix");

            if (error) {
                container.innerHTML = "<p>‚ùå Erreur lors du chargement des prix.</p>";
                console.error(error);
                return;
            }

            if (!data || data.length === 0) {
                container.innerHTML = "<p>Aucun prix d√©fini pour le moment.</p>";
                return;
            }

            // Grouper par cat√©gorie
            const categories = {};
            data.forEach(item => {
                if (!categories[item.categorie]) categories[item.categorie] = [];
                categories[item.categorie].push(item);
            });

            // G√©n√©rer les sections
            container.innerHTML = "";
            for (const [categorie, produits] of Object.entries(categories)) {
                let html = `
                    <section>
                        <h2>${categorie}</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>Prix Adh√©rent</th>
                                    <th>Prix Non-Adh√©rent</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                produits.forEach(p => {
                    html += `
                        <tr>
                            <td>${p.nom}</td>
                            <td>${p.prix_adherent !== null ? p.prix_adherent + " ‚Ç¨" : "Non d√©fini"}</td>
                            <td>${p.prix_non_adherent !== null ? p.prix_non_adherent + " ‚Ç¨" : "Non d√©fini"}</td>
                        </tr>
                    `;
                });
                html += `</tbody></table></section>`;
                container.innerHTML += html;
            }
        }

        chargerPrix();
    </script>
</body>
</html>
